---
import BaseLayout from "../../layouts/BaseLayout.astro";
const posts = await Astro.glob("./*.(md|mdx)");
---

<BaseLayout>
    <h1>Blog</h1>
    <p>
        You can <a href="/newsletter">subscribe</a> to my newsletter for future posts.
    </p>

    {
        posts
            .sort((a, b) =>
                a.frontmatter.date < b.frontmatter.date ||
                (a.frontmatter.date && !b.frontmatter.date)
                    ? 1
                    : -1
            )
            .map(
                (post) =>
                    ((!post.frontmatter.draft && !post.frontmatter.unlisted) ||
                        import.meta.env.DEV) && (
                        <p>
                            <em>{post.frontmatter.date || "Draft"}</em>
                            &middot;
                            <a href={post.url}>{post.frontmatter.title}</a>
                        </p>
                    )
            )
    }
</BaseLayout>
